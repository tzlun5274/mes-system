# 全局共用分頁組件使用說明

## 概述

MES 系統提供全局共用的分頁組件，讓所有列表頁面都能使用統一的分頁功能，符合 MES_程式開發設計規範。

## 組件特色

### 🎨 **統一設計風格**
- Bootstrap 5 響應式設計
- 符合 MES 系統視覺規範
- 支援無障礙設計

### 🔧 **功能完整**
- 第一頁/最後一頁快速跳轉
- 上一頁/下一頁導航
- 頁碼顯示（當前頁前後3頁）
- 分頁資訊顯示
- 自動隱藏單頁分頁

### 📱 **響應式支援**
- 桌面版顯示完整文字
- 手機版只顯示圖示
- 自適應各種螢幕尺寸

## 使用方式

### 1. 基本使用（推薦）

在模板中載入分頁標籤並使用：

```django
{% extends 'base.html' %}
{% load pagination_tags %}

{% block content %}
<!-- 你的表格內容 -->
<table>
    <!-- 表格資料 -->
</table>

<!-- 使用全局共用分頁組件 -->
{% include 'includes/pagination.html' with page_obj=your_page_object %}
{% endblock %}
```

### 2. 進階使用（帶查詢參數）

如果需要保留查詢參數：

```django
{% include 'includes/pagination.html' with page_obj=reports extra_params='equipment=1&status=pending' %}
```

### 3. 使用模板標籤

也可以使用自定義模板標籤：

```django
{% load pagination_tags %}

<!-- 渲染完整分頁組件 -->
{% render_pagination page_obj %}

<!-- 獲取分頁資訊 -->
{% get_pagination_info page_obj as pagination_info %}
當前頁：{{ pagination_info.current_page }}

<!-- 建立分頁 URL -->
<a href="{% build_pagination_url 2 equipment=1 %}">第2頁</a>

<!-- 分頁範圍 -->
{% for num in page_obj|pagination_range:3 %}
    <a href="?page={{ num }}">{{ num }}</a>
{% endfor %}
```

## 後端設定

### Django ListView 設定

```python
class YourListView(LoginRequiredMixin, ListView):
    model = YourModel
    template_name = 'your_template.html'
    context_object_name = 'your_objects'
    paginate_by = 20  # 每頁顯示20筆
    ordering = ['-created_at']
```

### 函數式視圖設定

```python
from django.core.paginator import Paginator

def your_view(request):
    queryset = YourModel.objects.all()
    paginator = Paginator(queryset, 20)
    page_number = request.GET.get('page')
    page_obj = paginator.get_page(page_number)
    
    context = {
        'page_obj': page_obj,
        'your_objects': page_obj,
    }
    return render(request, 'your_template.html', context)
```

## 檔案結構

```
templates/
├── includes/
│   └── pagination.html          # 全局共用分頁組件
workorder/
├── templatetags/
│   ├── __init__.py
│   └── pagination_tags.py       # 分頁相關模板標籤
```

## 樣式自訂

分頁組件使用 Bootstrap 5 樣式，如需自訂可在 CSS 中覆寫：

```css
/* 自訂分頁樣式 */
.pagination .page-link {
    border-radius: 4px;
    margin: 0 2px;
}

.pagination .page-item.active .page-link {
    background-color: #007bff;
    border-color: #007bff;
}
```

## 注意事項

1. **必須傳入 page_obj 參數**：分頁組件需要 Django 的 Page 物件
2. **查詢參數處理**：使用 `extra_params` 傳遞額外的查詢參數
3. **響應式設計**：組件會自動適應不同螢幕尺寸
4. **無障礙支援**：包含適當的 ARIA 標籤和語義化 HTML

## 範例

### 完整的列表頁面範例

```django
{% extends 'base.html' %}
{% load pagination_tags %}

{% block title %}我的列表{% endblock %}

{% block content %}
<div class="container">
    <h1>我的列表</h1>
    
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>名稱</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                {% for item in page_obj %}
                <tr>
                    <td>{{ item.id }}</td>
                    <td>{{ item.name }}</td>
                    <td>
                        <a href="{% url 'item_detail' item.id %}" class="btn btn-sm btn-primary">詳情</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- 使用全局共用分頁組件 -->
    {% include 'includes/pagination.html' with page_obj=page_obj %}
</div>
{% endblock %}
```

## 更新記錄

- **v1.0**：初始版本，支援基本分頁功能
- **v1.1**：新增模板標籤支援
- **v1.2**：優化響應式設計
- **v1.3**：新增無障礙支援

---

**遵循 MES_程式開發設計規範，確保所有分頁功能的一致性與可維護性。** 