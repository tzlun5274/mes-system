{% extends 'base.html' %}
{% load static %}

{% block title %}主管已審核填報作業{% endblock %}

{% block content %}
<div class="container-fluid py-3">
	<div class="mb-2">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb mb-2">
				<li class="breadcrumb-item">
					<a href="{% url 'workorder:fill_work:fill_work_index' %}"><i class="fas fa-home"></i> 填報管理</a>
				</li>
				<li class="breadcrumb-item">
					<a href="{% url 'workorder:fill_work:supervisor_approval_index' %}"><i class="fas fa-user-shield"></i> 主管審核</a>
				</li>
				<li class="breadcrumb-item active" aria-current="page">已審核</li>
			</ol>
		</nav>
	</div>
	<h4 class="mb-3"><i class="fas fa-clipboard-list me-2"></i>主管已審核填報作業</h4>
	<div class="mb-3 text-muted">共 {{ total_count }} 筆（已核准 {{ approved_count }}、已駁回 {{ rejected_count }}）</div>
	<div class="card">
		<div class="card-body p-0">
			<div class="table-responsive">
				<table class="table table-hover table-sm mb-0">
					<thead>
						<tr>
							<th>狀態</th>
							<th>類型</th>
							<th>作業員/設備</th>
							<th>工單</th>
							<th>產品</th>
							<th>日期</th>
							<th>開始</th>
							<th>數量</th>
							<th class="text-end">操作</th>
						</tr>
					</thead>
					<tbody>
					{% for r in fill_works %}
						<tr>
							<td>
								{% if r.approval_status == 'approved' %}
									<span class="badge bg-success">已核准</span>
								{% else %}
									<span class="badge bg-danger">已駁回</span>
								{% endif %}
							</td>
							<td>{% if 'SMT' in r.operator|upper or 'SMT' in r.process.name|upper %}SMT{% else %}作業員{% endif %}</td>
							<td>{{ r.operator|default:r.equipment }}</td>
							<td>{{ r.workorder }}</td>
							<td>{{ r.product_id }}</td>
							<td>{{ r.work_date|date:'Y-m-d' }}</td>
							<td>{{ r.start_time|time:'H:i' }}</td>
							<td>{{ r.work_quantity }}</td>
							<td class="text-end">
								<a href="{% url 'workorder:fill_work:fill_work_detail' r.id %}" class="btn btn-outline-primary btn-sm"><i class="fas fa-eye"></i></a>
							</td>
						</tr>
					{% empty %}
						<tr><td colspan="9" class="text-center text-muted py-3">目前沒有已審核的填報</td></tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
    {% include 'includes/pagination.html' with page_obj=page_obj %}
</div>
{% endblock %} 