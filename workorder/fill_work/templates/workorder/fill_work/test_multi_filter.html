{% extends 'base.html' %}
{% load static %}

{% block title %}測試多重過濾功能{% endblock %}

{% block content %}
<div class="container-fluid py-3">
    <div class="mb-2">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-2">
                <li class="breadcrumb-item">
                    <a href="{% url 'workorder:fill_work:fill_work_index' %}"><i class="fas fa-home"></i> 填報管理</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">測試多重過濾功能</li>
            </ol>
        </nav>
    </div>
    
    <h4 class="mb-3"><i class="fas fa-filter me-2"></i>測試多重過濾功能</h4>
    
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">使用者資訊</h5>
                </div>
                <div class="card-body">
                    <p><strong>使用者名稱：</strong>{{ user.username }}</p>
                    <p><strong>使用者ID：</strong>{{ user.id }}</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-3">
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">作業員過濾結果 ({{ operator_count }} 項)</h5>
                </div>
                <div class="card-body">
                    <h6>作業員選項：</h6>
                    <ul class="list-group">
                        {% for choice in filtered_choices.operators %}
                            <li class="list-group-item">{{ choice.0 }} - {{ choice.1 }}</li>
                        {% endfor %}
                    </ul>
                    
                    <h6 class="mt-3">作業員查詢集：</h6>
                    <ul class="list-group">
                        {% for operator in operator_queryset %}
                            <li class="list-group-item">{{ operator.name }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">工序過濾結果 ({{ process_count }} 項)</h5>
                </div>
                <div class="card-body">
                    <h6>工序選項：</h6>
                    <ul class="list-group">
                        {% for choice in filtered_choices.processes %}
                            <li class="list-group-item">{{ choice.0 }} - {{ choice.1 }}</li>
                        {% endfor %}
                    </ul>
                    
                    <h6 class="mt-3">工序查詢集：</h6>
                    <ul class="list-group">
                        {% for process in process_queryset %}
                            <li class="list-group-item">{{ process.name }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">設備過濾結果 ({{ equipment_count }} 項)</h5>
                </div>
                <div class="card-body">
                    <h6>設備選項：</h6>
                    <ul class="list-group">
                        {% for choice in filtered_choices.equipments %}
                            <li class="list-group-item">{{ choice.0 }} - {{ choice.1 }}</li>
                        {% endfor %}
                    </ul>
                    
                    <h6 class="mt-3">設備查詢集：</h6>
                    <ul class="list-group">
                        {% for equipment in equipment_queryset %}
                            <li class="list-group-item">{{ equipment.name }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-3">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">原始資料</h5>
                </div>
                <div class="card-body">
                    <h6>完整的過濾選項：</h6>
                    <pre>{{ filtered_choices|pprint }}</pre>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-3">
        <div class="col-12">
            <a href="{% url 'workorder:fill_work:operator_backfill_create' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i> 前往新增作業員填報
            </a>
            <a href="{% url 'workorder:fill_work:fill_work_index' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> 返回填報管理
            </a>
        </div>
    </div>
</div>
{% endblock %} 