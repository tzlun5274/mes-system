# SMT補登報工自動帶出功能說明

## 功能概述

本功能實現了產品編號和工單編號的互相自動帶出，讓使用者在填寫SMT補登報工記錄時更加便利。

## 主要特性

### 1. 雙向自動帶出
- **選擇產品編號** → 自動帶出對應的工單編號
- **選擇工單編號** → 自動帶出對應的產品編號

### 2. 即時響應
- 使用AJAX技術，無需重新載入頁面
- 選擇後立即自動填充對應欄位

### 3. 錯誤處理
- 找不到對應資料時會顯示錯誤訊息
- 網路請求失敗時會提示使用者

## 技術實現

### 後端API
1. **get_workorder_by_product_code/** - 根據產品編號查詢工單編號
2. **get_product_code_by_workorder/** - 根據工單編號查詢產品編號

### 前端JavaScript
- 監聽產品編號和工單編號選擇框的變更事件
- 發送AJAX請求到對應的API端點
- 根據回應結果自動填充或顯示錯誤訊息

### 表單修改
- 將工單編號欄位從唯讀文字框改為下拉選擇框
- 保持產品編號為下拉選擇框
- 兩個欄位都支援手動選擇和自動帶出

## 使用方式

### 1. 正常使用
1. 進入SMT補登報工創建頁面
2. 選擇產品編號 → 工單編號會自動帶出
3. 或選擇工單編號 → 產品編號會自動帶出
4. 繼續填寫其他欄位並提交

### 2. 測試功能
1. 點擊「測試自動帶出功能」按鈕
2. 在測試頁面中體驗自動帶出功能
3. 可以點擊「測試自動帶出」按鈕進行隨機測試

## 檔案修改清單

### 新增檔案
- `workorder/templates/workorder/supplement_report/test_form.html` - 測試頁面

### 修改檔案
- `workorder/forms.py` - 修改表單欄位定義
- `workorder/views.py` - 新增API端點和測試視圖
- `workorder/urls.py` - 新增URL路由
- `workorder/templates/workorder/supplement_report/form.html` - 新增JavaScript功能
- `workorder/templates/workorder/supplement_report/index.html` - 新增測試按鈕

## 注意事項

1. **資料一致性**：確保產品編號和工單編號在資料庫中的對應關係正確
2. **效能考量**：大量資料時可能需要考慮分頁或搜尋功能
3. **錯誤處理**：網路異常時會顯示友善的錯誤訊息
4. **使用者體驗**：自動帶出後可以手動修改，提供彈性操作

## 未來擴展

1. **搜尋功能**：可以加入模糊搜尋，支援部分關鍵字查詢
2. **快取機制**：對於常用資料可以加入快取提升效能
3. **批量操作**：支援批量選擇和自動帶出
4. **歷史記錄**：記錄使用者的選擇歷史，提供快速選擇

## 測試建議

1. **基本功能測試**：測試產品編號和工單編號的互相帶出
2. **錯誤情況測試**：測試不存在的編號或網路異常情況
3. **邊界條件測試**：測試空值、特殊字元等情況
4. **效能測試**：測試大量資料時的響應速度 