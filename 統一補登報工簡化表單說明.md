# 統一補登報工簡化表單說明

## 概述

統一補登報工簡化表單 (`UnifiedWorkReportSimpleForm`) 是一個專門為快速報工設計的表單，只包含最基本必要的欄位，提供更好的用戶體驗。

## 表單欄位

### 基本欄位
1. **公司代號** (`company_code`)
   - 類型：CharField
   - 必填：是
   - 預設值：01
   - 說明：公司代號，例如：01、02、03

2. **產品編號** (`product_id`)
   - 類型：CharField
   - 必填：是
   - 說明：產品編號

3. **工單號碼** (`workorder`)
   - 類型：ForeignKey 到 WorkOrder
   - 必填：是
   - 說明：選擇工單號碼

4. **作業員** (`operator`)
   - 類型：CharField
   - 必填：是
   - 說明：作業員姓名

5. **工序** (`process`)
   - 類型：ForeignKey 到 ProcessName
   - 必填：是
   - 說明：選擇工序

6. **使用的設備** (`equipment`)
   - 類型：CharField
   - 必填：否
   - 說明：設備名稱或編號

### 數量欄位
7. **工單預設生產數量** (`planned_quantity`)
   - 類型：IntegerField
   - 必填：是
   - 說明：工單預設的生產數量

8. **工作數量** (`work_quantity`)
   - 類型：IntegerField
   - 必填：是
   - 預設值：0
   - 說明：實際完成的工作數量（良品）

9. **不良品數量** (`defect_quantity`)
   - 類型：IntegerField
   - 必填：否
   - 預設值：0
   - 說明：不良品數量

### 時間欄位
10. **報工日期** (`work_date`)
    - 類型：DateField
    - 必填：是
    - 特殊設計：
      - HTML5 date picker
      - 新增時預設為今天日期
      - 不能選擇未來日期

11. **開始時間** (`start_time`)
    - 類型：TimeField
    - 必填：是
    - 特殊設計：
      - 支援手動輸入（HH:MM格式）
      - 自動驗證時間格式
      - 24小時制
      - HTML5 time picker

12. **結束時間** (`end_time`)
    - 類型：TimeField
    - 必填：是
    - 特殊設計：
      - 同開始時間
      - 必須晚於開始時間

### 狀態欄位
12. **是否已完工** (`is_completed`)
    - 類型：BooleanField
    - 必填：否
    - 預設值：False
    - 特殊設計：勾選欄位

### 備註欄位
13. **備註** (`remarks`)
    - 類型：TextField
    - 必填：否
    - 說明：一般備註

14. **異常記錄** (`abnormal_notes`)
    - 類型：TextField
    - 必填：否
    - 說明：異常記錄

## 特殊設計功能

### 1. 日期選擇器
- 使用 HTML5 `type="date"` 輸入
- 新增時自動預設為今天日期
- 前端 JavaScript 自動設定預設值
- 後端驗證不能選擇未來日期

### 2. 時間選擇器
- 使用 HTML5 `type="time"` 輸入
- 支援手動輸入 HH:MM 格式
- 自動格式化時間輸入
- 24小時制顯示
- 前端驗證時間格式
- 後端驗證結束時間必須晚於開始時間

### 3. 自動填入功能
當選擇工單時，系統會自動填入：
- 原始工單號碼
- 產品編號
- 工單預設生產數量

當選擇工序時，系統會自動填入：
- 工序名稱

### 4. 表單驗證
- 前端 JavaScript 即時驗證
- 後端 Django 表單驗證
- 時間邏輯驗證
- 數量邏輯驗證
- 日期邏輯驗證

## 使用方式

### 1. 訪問路徑
- 新增頁面：`/unified-work-reporting/create/`
- 編輯頁面：`/unified-work-reporting/<id>/edit/`

### 2. 操作步驟
1. 選擇工單號碼（會自動填入相關資訊）
2. 選擇工序（會自動填入工序名稱）
3. 輸入作業員姓名
4. 輸入使用的設備（可選）
5. 輸入工作數量和不良品數量
6. 選擇報工日期（預設今天）
7. 輸入開始時間和結束時間
8. 勾選是否已完工（可選）
9. 輸入備註和異常記錄（可選）
10. 點擊儲存

### 3. 表單特色
- **簡潔設計**：只顯示必要欄位，減少填寫時間
- **智能預設**：自動填入常用資訊
- **即時驗證**：前端即時檢查輸入格式
- **全寬佈局**：充分利用螢幕空間
- **響應式設計**：完美支援各種螢幕尺寸
- **行動裝置友善**：觸控友善的介面設計
- **用戶友善**：清晰的標籤和說明文字

## 技術實作

### 1. 表單類別
```python
class UnifiedWorkReportSimpleForm(forms.ModelForm):
    class Meta:
        model = UnifiedWorkReport
        fields = [
            'product_id', 'workorder', 'operator', 'process', 'equipment',
            'planned_quantity', 'work_quantity', 'defect_quantity',
            'work_date', 'start_time', 'end_time', 'is_completed',
            'remarks', 'abnormal_notes'
        ]
```

### 2. 特殊欄位設定
```python
'work_date': forms.DateInput(attrs={
    'class': 'form-control',
    'type': 'date',
    'placeholder': '請選擇日期'
}),
'start_time': forms.TimeInput(attrs={
    'class': 'form-control time-input',
    'type': 'time',
    'placeholder': 'HH:MM',
    'pattern': '[0-9]{2}:[0-9]{2}'
}),
```

### 3. 預設值設定
```python
def __init__(self, *args, **kwargs):
    super().__init__(*args, **kwargs)
    
    if not self.instance.pk:  # 新增時
        from datetime import date
        self.fields['work_date'].initial = date.today()
        self.fields['work_quantity'].initial = 0
        self.fields['defect_quantity'].initial = 0
        self.fields['is_completed'].initial = False
```

### 4. 前端 JavaScript
- 自動設定今天日期
- 時間格式驗證
- 即時錯誤提示
- 表單提交驗證

## 與完整表單的差異

| 功能 | 簡化表單 | 完整表單 |
|------|----------|----------|
| 欄位數量 | 14個 | 25個 |
| 休息時間 | ❌ | ✅ |
| 核准流程 | ❌ | ✅ |
| 公司代號 | 自動填入 | 手動選擇 |
| 原始工單號碼 | 自動填入 | 手動輸入 |
| 工序名稱 | 自動填入 | 手動輸入 |
| 使用場景 | 快速報工 | 完整管理 |

## 注意事項

1. **簡化表單**專為快速報工設計，不包含完整的核准流程
2. **公司代號**預設為 '01'，如需修改請使用完整表單
3. **休息時間**功能在簡化表單中不可用
4. **核准狀態**在簡化表單中不可修改
5. 所有**自動填入**的欄位仍可在後台編輯

## 響應式設計特色

### 1. 全寬佈局
- 移除固定寬度限制，充分利用螢幕空間
- 桌面版：欄位並排顯示，提高填寫效率
- 平板版：自適應欄位佈局
- 手機版：欄位垂直排列，觸控友善

### 2. 行動裝置優化
- **觸控友善**：最小按鈕高度 44px，符合觸控標準
- **防止縮放**：字體大小 16px，防止 iOS 自動縮放
- **緊湊檢視**：行動裝置專用的緊湊模式
- **自適應佈局**：根據螢幕大小自動調整

### 3. 媒體查詢斷點
- **桌面版** (>768px)：完整佈局，欄位並排
- **平板版** (768px-480px)：自適應佈局
- **手機版** (<480px)：垂直佈局，緊湊設計

### 4. 特殊功能
- **檢視切換**：行動裝置上的緊湊/展開檢視切換
- **自動調整**：視窗大小變化時自動調整佈局
- **觸控優化**：所有輸入欄位都經過觸控優化

## 未來擴展

1. **批次報工**：支援一次填寫多筆報工記錄
2. **快速選擇**：常用作業員和設備的快速選擇
3. **模板功能**：儲存常用報工模板
4. **語音輸入**：支援語音輸入功能
5. **手勢操作**：支援滑動手勢操作
6. **離線功能**：支援離線填寫，連線後同步 